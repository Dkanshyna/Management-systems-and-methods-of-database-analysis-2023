USE WebStor;

--TASK 1

SELECT DISTINCT MFR
FROM CUSTOMERS
INNER JOIN ORDERS ON [CUST_REP] = [REP]
WHERE [ORDER_DATE] BETWEEN '2008-01-01' AND '2009-01-01'
 AND COMPANY LIKE '%CORP%';
 GO

 --TASK 2 
 SELECT CUST_NUM, MONTH(ORDER_DATE) AS Month_of_order, COUNT (DISTINCT ORDER_NUM) AS Number_of_unique_orders
 FROM CUSTOMERS
 LEFT OUTER JOIN ORDERS ON CUST_NUM = CUST
 WHERE [ORDER_DATE] BETWEEN '2008-01-01' AND '2009-01-01'
 AND COMPANY LIKE '%CORP%'
 GROUP BY CUST_NUM, MONTH(ORDER_DATE)
 ORDER BY Number_of_unique_orders DESC;
 GO

 --TASK 3 

 SELECT DISTINCT [CUST_NUM], UPPER([COMPANY]) AS Name_of_company, [DESCRIPTION]
 FROM [CUSTOMERS]
 LEFT OUTER JOIN [ORDERS] ON [CUST_NUM] = [CUST]
 LEFT OUTER JOIN [PRODUCTS] ON [PRODUCT_ID] = [PRODUCT]
 WHERE [ORDER_DATE] BETWEEN  '2008-01-01' AND '2009-01-01'
 AND COMPANY LIKE '%CORP%';

 GO



 
  
